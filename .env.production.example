# ============================================
# 智能记账助手 - 生产环境变量配置示例
# ============================================
# 复制此文件为 .env.production 并修改相应配置
# 注意：不要将包含真实密钥的 .env.production 文件提交到Git

# ============================================
# 应用基础配置
# ============================================
NODE_ENV=production
PORT=3000
APP_NAME=智能记账助手
APP_VERSION=1.0.0
API_PREFIX=/api/v1
APP_URL=https://your-domain.com

# ============================================
# 数据库配置 (PostgreSQL)
# ============================================
# 生产环境数据库连接字符串
DATABASE_URL=postgresql://user:password@postgres:5432/smart_finance?schema=public
DATABASE_SSL=true

# Docker Compose环境变量
POSTGRES_USER=admin
POSTGRES_PASSWORD=CHANGE_THIS_STRONG_PASSWORD
POSTGRES_DB=smart_finance

# ============================================
# Redis配置
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_THIS_STRONG_REDIS_PASSWORD
REDIS_DB=0
REDIS_TTL=60

# ============================================
# JWT认证配置
# ============================================
# 使用以下命令生成密钥：
# openssl rand -base64 32
# 或使用: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=CHANGE_THIS_JWT_SECRET_MIN_32_CHARACTERS
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=CHANGE_THIS_JWT_REFRESH_SECRET_MIN_32_CHARACTERS
JWT_REFRESH_EXPIRES_IN=30d

# ============================================
# 文件上传配置
# ============================================
UPLOAD_MAX_FILE_SIZE=10485760
UPLOAD_ALLOWED_EXTENSIONS=jpg,jpeg,png,pdf,doc,docx

# ============================================
# MinIO对象存储配置
# ============================================
MINIO_ENDPOINT=minio
MINIO_PORT=9000
MINIO_ACCESS_KEY=CHANGE_THIS_MINIO_ACCESS_KEY
MINIO_SECRET_KEY=CHANGE_THIS_MINIO_SECRET_KEY
MINIO_BUCKET=smart-finance
MINIO_USE_SSL=false

# ============================================
# AI服务配置
# ============================================
# DeepSeek API配置（推荐）
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_API_URL=https://api.deepseek.com/v1/chat/completions
DEEPSEEK_MODEL=deepseek-chat

# OpenAI API配置（可选，作为备选）
OPENAI_API_KEY=your_openai_api_key_here

# AI服务超时时间（毫秒）
AI_SERVICE_TIMEOUT=30000

# ============================================
# 邮件服务配置
# ============================================
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your_email@example.com
SMTP_PASS=your_email_password
EMAIL_FROM=noreply@smartfinance.com

# ============================================
# 安全配置
# ============================================
# CORS允许的源（多个用逗号分隔）
CORS_ORIGIN=https://your-domain.com,https://www.your-domain.com

# 速率限制配置
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100

# ============================================
# 监控和日志配置
# ============================================
# Sentry错误监控
SENTRY_DSN=your_sentry_dsn_here

# 日志配置
LOG_LEVEL=info
LOG_FORMAT=json

# Grafana密码
GRAFANA_PASSWORD=CHANGE_THIS_GRAFANA_PASSWORD

# ============================================
# 功能开关
# ============================================
# 启用AI功能
FEATURE_AI_ENABLED=true

# 启用邮箱验证
FEATURE_EMAIL_VERIFICATION=true

# 启用短信验证
FEATURE_SMS_VERIFICATION=false

# ============================================
# 生产环境特定配置
# ============================================
# 是否启用Swagger文档（生产环境建议关闭）
ENABLE_SWAGGER=false

# 是否启用数据库同步（生产环境必须设为false）
DATABASE_SYNC=false

# 是否启用详细日志（生产环境建议设为false）
VERBOSE_LOGGING=false

# ============================================
# 说明
# ============================================
# 1. 必需配置（必须修改）：
#    - DATABASE_URL: 数据库连接字符串
#    - POSTGRES_PASSWORD: 数据库密码
#    - REDIS_PASSWORD: Redis密码
#    - JWT_SECRET: JWT密钥（至少32个字符）
#    - JWT_REFRESH_SECRET: JWT刷新密钥（至少32个字符）
#    - MINIO_ACCESS_KEY / MINIO_SECRET_KEY: MinIO访问密钥
#    - CORS_ORIGIN: 允许的前端域名
#    - APP_URL: 应用访问地址
#
# 2. 推荐配置：
#    - DEEPSEEK_API_KEY: AI功能需要
#    - SENTRY_DSN: 错误监控需要
#    - SMTP相关: 邮件功能需要
#    - GRAFANA_PASSWORD: 监控面板密码
#
# 3. 生成密钥的方法：
#    - JWT密钥: openssl rand -base64 32
#    - 或使用: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# 4. 安全提示：
#    - 生产环境必须使用强密码和密钥
#    - 定期轮换密钥和密码
#    - 使用环境变量管理工具（如AWS Secrets Manager）
#    - 不要将包含真实密钥的 .env.production 文件提交到Git
